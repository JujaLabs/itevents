branches:
  only:
  - master
language: java
jdk:
- oraclejdk8
addons:
  postgresql: '9.2'
services:
- postgresql
before_install:
- cp .travis/properties/travis.properties restservice/src/main/resources/local.properties
- cp .travis/properties/test-travis.properties restservice/src/test/resources/test-local.properties
before_script:
- psql -c 'create database itevents;' -U postgres
- psql -c 'create database test;' -U postgres
script:
- gradle test
after_success:
- git remote rename origin initial
- git remote rename openshift origin
deploy:
  provider: openshift
  user: $OPENSHIFT_USER
  password: $OPENSHIFT_PASSWORD
  domain: $OPENSHIFT_DOMAIN
  app: $OPENSHIFT_APP
before_cache:
- rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
cache:
  directories:
  - $HOME/.gradle/caches/
  - $HOME/.gradle/wrapper/
notifications:
  slack:
    secure: Y6XGs71xXRHJ6cGL7wSdv4bqRgm25vQoRNgFWmCbLlYyFkTSEkRpI7mE9rq8VdItr86L9O5ZakWMQlT15J6JJVkzaHAoUDGv5WnBPxZMgWcgnnNnjAwCudIhchVhXCPMgjuaCILftq0uLYfMw36SEZUk4yeW4eabn5RwLIuZVH2Dq+jq9uArrO0E6sZgYuJ7nnV2pxmVh36l8rCEmzderXjPsSBtpMkad9a1KRZ9Gd6Uoz7NIDEHZGmjmHFcVK9qD667tXr/P0r2qqnlew+fwYul1mxpVR95AnjFOYg6BUdJ2Wf9CbYRjcxPrRxoZtAdZtuo3WFrEUOYB4GtylTFiHSC2Gemw03e3l2vlCIP5g802xef19dd/1Sl6DXQ1thJnsJVofrEiK8ZdXZ1RCRPIB1pvCK84QoJgcQI0V3Ah2VT/F4WuZpPA0GsnGrlisSbJYm8lFH3mbiVYjBgYVr3zYvEVizWIGRpDQ0ceGkjjjZsm8PcdcMW/UxB6f3aKrxfFRegiCSRQgMOTKCnG01kfv34C4ZlAaGLMVDRa0kpnULgpqNM6JmyxXBf5rNV1hCfCl2VfWbNoxo+7UGSV+85aZFUHxC4bdHK5CR5RmD2xRo6bvKX0u3Xb93GXYTgdnvlS97xPtdrPST9o5FLcsGvgvshNfiDR4n1/vHF1wpKx3E=
