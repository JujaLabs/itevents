branches:
  only:
  - master
language: java
jdk:
- oraclejdk8
addons:
  postgresql: '9.2'
services:
- postgresql
before_install:
- cp .travis/properties/travis.properties restservice/src/main/resources/local.properties
- cp .travis/properties/test-travis.properties restservice/src/test/resources/test-local.properties
before_script:
- psql -c 'create database itevents;' -U postgres
- psql -c 'create database test;' -U postgres
script:
- gradle test
after_success:
- git remote rename origin initial
- git remote rename openshift origin
deploy:
  provider: openshift
  user: $OPENSHIFT_USER
  password: $OPENSHIFT_PASSWORD
  domain: $OPENSHIFT_DOMAIN
  app: $OPENSHIFT_APP
before_cache:
- rm -f $HOME/.gradle/caches/modules-2/modules-2.lock
cache:
  directories:
  - $HOME/.gradle/caches/
  - $HOME/.gradle/wrapper/
notifications:
  slack: $SLACK_URL